#!/usr/bin/env python
# -*- coding: utf8 -*-

import os, sys
import requests
from urllib.parse import urljoin
from bs4 import BeautifulSoup
import urllib.request

GenBank = ["MT008022","MT008023","MN988668","MN988669","LC521925","LC522972","LC522973","LC522974","LC522975","MN997409","MN994467","MN994468","MT027062","MT027063","MT027064","MT044258","MT106052","MT106053","MT118835","MT159717","MT159707","MT159708","MT159709","MT159711","MT159712","MT159713","MT159714","MT159715","MT159716","MT184907","MT159718","MT184908","MT184909","MT184910","MT184911","MT184912","MT184913","MT159719","MT159720","MT159721","MT159722","MT159705","MT159706","MT159710","MN988713","MT044257","MT039888","MT106054","MT020880","MT020881","MN985325","MT039887","MN938385","MN938387","MN938384","MN938388","MN938386","MN938389","MN938390","MN975262","MN975263","MN975266","MN975264","MN975267","MN975265","MN975268","LC523809","LC523808","LC522350","LC523807","MT007544","MT019529","MT019530","MT019531","MT019532","MT019533","MT039873","MT020781","MT093571","MT135041","MT186679","MT186676","MT186681","MT050493","MT135042","MT135043","MT135044","MT186677","MT186680","MT186678","MT012098","MT163714","MT163715","MT186682","MT192759","MT066157","MT066158","MT066159","MT072667","MT072668","MT081060","MT081061","MT081068","MT081062","MT081063","MT081064","MT081059","MT081065","MT081066","MT081067","LC528232","LC528233","MT066156","MT123290","MT123291","MT123293","MT123292","MT187977","MT192758","MT163712","MT152900","MT163737","MT163738","MT192772","MT192773","MT159778","MT161607","MT066175","MT066176","MT192765","MT050414","MT050415","MT050416","MT050417","MT111895","MT111896","MT121215","MT126808","MT042773","MT042774","MT042775","MT042776","MT042777","MT042778","MT152824","MT163716","MT163717","MT163718","MT163719","MT163720","MT163721","MT093631","MT049951","MT072688","MN970003","MN970004","MT039890","LC529905","LR757995","LR757996","LR757997","LR757998","MT188341","MT188340","MT188339","MN996527","MN996528","MN996529","MN996530","MN996531","MN908947"]
path_save = "base/"
base_total = ""
for i,gen in enumerate(GenBank):
	print(gen,i,"de",len(GenBank))
	url = "https://www.viprbrc.org/brc/segmentSequence.spg?sequenceAccession="+gen+"&decorator=corona"
	fid=urllib.request.urlopen(url)
	webpage=fid.read().decode("utf-8")
	e1 = webpage.split("sequenceFont")[1]
	e2 = e1.split("\n")[2:9]
	s = ""
	for l in e2:
		s = s+l
	# print(type(s))
	result = ""
	result = ''.join(i for i in s if not i.isdigit())
	result = result.replace(" ","")
	result = result.replace("\n","")
	base_total = base_total + gen +";"+result+"\n"
with open(path_save+"base"+".txt", "w") as text_file:
	text_file.write(base_total)